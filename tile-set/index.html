<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">

    <title>HTML5 Game</title>
    <meta name="description" content="A basic HTML5 game">
    <meta name="author" content="[Your name]">
</head>

<body style="background: black;">

    <p>Hello there</p>

    <img src="./assets/tileset8x8.png" id="tileset" alt="" style="display: none;">

    <canvas id="canvas-tileset" width="300" height="400" style="border:1px solid lightgrey;">
    </canvas>
    <canvas id="canvas-tiles" width="300" height="400" style="border:1px solid lightgrey;">
    </canvas>

    <script>
        "use strict";

        window.onload = init

        const ctx = document.getElementById('canvas-tileset').getContext('2d')
        const ctx_tiles = document.getElementById('canvas-tiles').getContext('2d')

        //Tiles
        let tiles
       
        //TileSet properties (a externaliser dans un fichier env lisible a l'execution)
        const tileW = 8
        const tileH = 8
        const tileSetWidth = 128
        const tileSetHeight = 128

        const nx = tileSetWidth / tileW
        const ny = tileSetHeight / tileH
        const nbTiles = nx * ny

        console.log(nx,ny, nbTiles)

        function init() {
            const tileset = document.getElementById('tileset')
            window.requestAnimationFrame(gameLoop)

            //Prepare tileSet to be parsed
            drawTileSet(tileset)
            tiles = parseTileSet()
            drawTiles(tiles)
        }

        function parseTileSet() {

            const tiles = Array()

            for (let i = 0; i < nbTiles; i++) {
                const x = (i % nx) * tileW
                const y = Math.floor(i / nx) * tileH
                const tile = ctx.getImageData(x, y, tileW, tileH)
                tiles.push(tile)
            }

            return tiles
        }

        function drawTiles(tiles){
            for (let i = 0; i < tiles.length; i++) {
                ctx_tiles.putImageData(tiles[i], 0 , i * tileH)
            }
        }

        function drawTileSet() {
            ctx.drawImage(tileset, 0, 0)
        }

        function gameLoop(timeStamp) {
            draw()
            // window.requestAnimationFrame(gameLoop)
        }


        function draw() {

        }
    </script>
</body>

</html>


<!-- Hello world
Installer lib Ramda
Installer gestionnaire d'Ã©tat Immer (opt) -->